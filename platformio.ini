; PlatformIO Project Configuration File
; https://docs.platformio.org/page/projectconf.html

[platformio]
default_envs = master

[env]
platform = espressif32
framework = arduino
monitor_speed = 115200

; ===========================================
; MASTER - CAN Reader + I2C Transmitter
; ===========================================
[env:master]
board = esp32-s3-devkitc-1
build_flags =
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1
build_src_filter =
    +<master/>
    -<master/gpio_test.cpp>
lib_deps =
    autowp/autowp-mcp2515@^1.0.0

; ===========================================
; SLAVE - I2C Receiver + Display
; ===========================================
[env:slave]
board = esp32-s3-devkitc-1
build_flags =
    -DARDUINO_USB_CDC_ON_BOOT=1
    ; TFT_eSPI configuration for ILI9341/ILI9341V 320x240 display
    -DUSER_SETUP_LOADED=1
    -DILI9341_DRIVER=1
    -DTFT_WIDTH=240
    -DTFT_HEIGHT=320
    ; ESP32-S3 uses FSPI (SPI2)
    -DUSE_FSPI_PORT=1
    ; SPI pins for ESP32-S3
    -DTFT_MISO=13
    -DTFT_MOSI=11
    -DTFT_SCLK=12
    -DTFT_CS=10
    -DTFT_DC=46
    -DTFT_RST=-1
    -DTFT_BL=45
    ; No SPI touch (using I2C FT6336G instead)
    -DTOUCH_CS=-1
    ; ILI9341V specific - uncomment if colors are inverted
    ; -DTFT_INVERSION_ON
    ; Fonts
    -DLOAD_GLCD=1
    -DLOAD_FONT2=1
    -DLOAD_FONT4=1
    -DLOAD_FONT6=1
    -DLOAD_FONT7=1
    -DLOAD_FONT8=1
    -DLOAD_GFXFF=1
    -DSMOOTH_FONT=1
    ; SPI speed - start lower for stability, increase if working
    -DSPI_FREQUENCY=27000000
    -DSPI_READ_FREQUENCY=16000000
build_src_filter =
    +<slave/>
    -<slave/gpio_test.cpp>
lib_deps =
    bodmer/TFT_eSPI@^2.5.0
    ; FT6336G touch uses direct I2C - no library needed
    ; SD card uses built-in SD_MMC library (SDIO interface)

; ===========================================
; Original generic ESP32 environment (kept for reference)
; ===========================================
[env:esp32dev]
board = esp32dev
build_src_filter =
    +<main.cpp>
